@page "/login"
@using System.ComponentModel.DataAnnotations

<PageTitle>Connexion - GestionConge</PageTitle>

<MudContainer MaxWidth="MaxWidth.Small" Class="mt-8">
    <MudPaper Class="pa-6" Elevation="3">
        <MudText Typo="Typo.h4" Class="mb-4 text-center" Color="Color.Primary">
            <MudIcon Icon="@Icons.Material.Filled.Login" Class="mr-2" />
            Connexion
        </MudText>

        <EditForm Model="@loginModel" OnValidSubmit="HandleValidSubmit">
            <DataAnnotationsValidator />
            <ValidationSummary />

                         <MudTextField @bind-Value="loginModel.Username" 
                          Label="Nom d'utilisateur" 
                          Required="true"
                          RequiredError="Le nom d'utilisateur est requis"
                          AdornmentIcon="@Icons.Material.Filled.Person"
                          Adornment="Adornment.Start"
                          Class="mb-3" />

             <MudTextField @bind-Value="loginModel.Password" 
                          Label="Mot de passe" 
                          Required="true"
                          RequiredError="Le mot de passe est requis"
                          AdornmentIcon="@Icons.Material.Filled.Lock"
                          Adornment="Adornment.Start"
                          InputType="InputType.Password"
                          Class="mb-3" />

             <MudCheckBox T="bool" @bind-Checked="loginModel.RememberMe" 
                         Color="Color.Primary" 
                         Label="Se souvenir de moi"
                         Class="mb-4" />

            <MudButton ButtonType="ButtonType.Submit" 
                      Variant="Variant.Filled" 
                      Color="Color.Primary"
                      FullWidth="true"
                      StartIcon="@Icons.Material.Filled.Login"
                      Class="mb-3">
                Se connecter
            </MudButton>

            <MudDivider Class="my-3" />

            <MudText Typo="Typo.body2" Class="text-center mb-2">
                Pas encore de compte ?
            </MudText>
            <MudButton Variant="Variant.Text" 
                      Color="Color.Secondary"
                      FullWidth="true"
                      Href="/register"
                      StartIcon="@Icons.Material.Filled.PersonAdd">
                Créer un compte
            </MudButton>

            <MudText Typo="Typo.body2" Class="text-center mt-3">
                <MudLink Href="/forgot-password" Color="Color.Primary">
                    Mot de passe oublié ?
                </MudLink>
            </MudText>
        </EditForm>
    </MudPaper>
</MudContainer>

@code {
    private LoginModel loginModel = new();

    public class LoginModel
    {
        [Required(ErrorMessage = "Le nom d'utilisateur est requis")]
        public string Username { get; set; } = "";

        [Required(ErrorMessage = "Le mot de passe est requis")]
        [StringLength(100, MinimumLength = 6, ErrorMessage = "Le mot de passe doit contenir au moins 6 caractères")]
        public string Password { get; set; } = "";

        public bool RememberMe { get; set; }
    }

    private void HandleValidSubmit()
    {
        // TODO: Implémenter la logique d'authentification
        Console.WriteLine($"Tentative de connexion pour : {loginModel.Username}");
    }
} 